include utils.pug
doctype html
html
  head
      block head
        title="Project Zuora"
        link(rel='stylesheet' href='/stylesheets/questions.css')
        link(rel='stylesheet' href='/stylesheets/nav.css')

  body
    +navBar()
    div.container
      div.sideBar
        ul.sideBarList
          each tag in tags
            li.listItem= tag.name
      div.main
        if(locals.authenticated)
          a(href= "/questions/add" class="question_link") Ask a Question
        each question in questions
          div.question
            div.question_head
              div.user_img
                if (question.User.picSrc)
                  img(src=question.User.picSrc class="user_profile_pic")
                else
                  img( class="user_profile_pic" src="https://pngset.com/images/the-legend-of-zelda-zelda-majoras-mask-zora-graphics-art-leisure-activities-person-transparent-png-1598670.png")
              div.head_text
                div.question_head_upper
                  a(href=`/users/${question.userId}` class='user_profile_link')= question.User.fullName
                div.question_head_lower
                  p= question.User.credentials
            div.question_body
              div.question_body_title
                p= question.title
              div.question_body_content
                p= question.content
              if (question.media)
                div.question_body_img
                  img(class="questions_img" src=question.media)
              else
                div.question_body_img
                  img(class="questions_img" src="https://pngset.com/images/the-legend-of-zelda-zelda-majoras-mask-zora-graphics-art-leisure-activities-person-transparent-png-1598670.png")
            div.question_footer
              div.post_answer
                button View Thread
            .answer-inner-container
              if(locals.authenticated)
                .answer-inner
                  img(src=loggedInUser.picSrc class='user_profile_pic_answer')
                  form(action=`/questions/${question.User.id}/answers` method="POST")
                    input(type='hidden' name='_csrf' value=csrfToken)
                    div.inner-input-container
                      input(type='text' id=`answer-content-${question.id}` name=locals.user.id value='' placeholder='Your answer here' class='answer-popup-form')
                      button(type='submit'  id=question.id data-id=locals.user.id class='submit-answer-button') Submit Answer
                    //- a(href=`/questions/` class='cancel-answer-button') Cancel
            div.answer_section(class=`answer-section-${question.id}`)
             each answer in question.Answers
               div.answer(id=`answer-div-${answer.id}`)
                 div.answer_head
                   if(answer.User.picSrc)
                    img(src=answer.User.picSrc class="user_profile_pic")
                   else
                     img(class="questions_img" src="https://pngset.com/images/the-legend-of-zelda-zelda-majoras-mask-zora-graphics-art-leisure-activities-person-transparent-png-1598670.png")
                   if (question.Answers)
                     div.answer_details
                       p.answer_user_name= answer.User.fullName
                       p.answer_date= answer.createdAt
                 div.answer_content
                   p.p_answer_content(id=`answer_content_${answer.id}`)= answer.content
                   if locals.authenticated
                     button.show_comments_btn.reply_answer_btn Reply
                       if(answer.userId===locals.user.id)
                        button(class='edit_answer_btn' name=`${answer.id}`) Edit
                       if(answer.userId===locals.user.id)
                        button(class='delete_answer_btn' name=`${answer.id}`) Delete

               div.comment_section
                 if(answer.Comments.length > 0)
                   p(class="answers_header" id=`comment_head_${answer.id}`) Comments
                 each comment in answer.Comments
                  div.total_comment(id=`comment_answer_${answer.id}`)
                   div.comment_head
                     if(answer.Comments)
                         img(src=answer.User.picSrc class="user_profile_pic_comment")
                         div.user_comment_details
                           p.user_of_comment= comment.User.fullName
                           p= comment.createdAt
                   div.comment_body
                     p= comment.content
      div.right_img
        img(src="https://freepngimg.com/thumb/the_legend_of_zelda/21249-6-zelda-link-hd.png")
        script
          include ../public/javascript/question-page.js
